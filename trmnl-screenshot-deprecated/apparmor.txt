#include <tunables/global>

profile screenshot_addon flags=(attach_disconnected,mediate_deleted) {
  #include <abstractions/base>

  # Allow reading system files
  /sys/kernel/mm/transparent_hugepage/hpage_pmd_size r,

  # Allow access to addon data
  /data/** rwk,

  # Allow access to shared volumes
  /share/** rwk,

  # Allow access to config
  /config/** r,

  # Allow Home Assistant API access
  /run/dbus/system_bus_socket rw,

  # Allow chromium/puppeteer access
  /proc/*/stat r,
  /proc/*/status r,
  /proc/*/maps r,
  /proc/*/limits r,
  /proc/*/fd/ r,
  /proc/*/fd/* r,
  /proc/sys/vm/overcommit_memory r,

  # Allow network access
  network inet dgram,
  network inet stream,
  network inet6 dgram,
  network inet6 stream,
  network unix dgram,
  network unix stream,
}
